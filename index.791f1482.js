const t=document.querySelector("tbody"),e=document.querySelector("button"),s=Array.from(t.children),a=new class{constructor(t){this.board=this.createEmptyBoard(),this.score=0,this.status="playing"}start(){this.deleteMessage(),this.clearBoard(),this.restart(),this.addSCore(),this.spawnTile(),this.spawnTile(),this.updateBoardFromDOM()}deleteMessage(){let t=document.querySelector(".message-container").children[2];t.classList.remove("message-lose"),t.classList.remove("message-win"),t.classList.remove("message"),t.textContent=""}spawnTile(){let e=()=>Math.floor(4*Math.random()),a=()=>.1>Math.random()?4:2,r=Array.from(t.children),i=!1;for(let t of r)if(Array.from(t.children).some(t=>""===t.textContent)){i=!0;break}if(i){let t;let r=!1;for(;!r;)(t=s[e()].children[e()]).classList.contains("activ")||(t.textContent=a(),t.classList.add("activ"),2==+t.textContent&&t.classList.add("field-cell--2"),4==+t.textContent&&t.classList.add("field-cell--4"),r=!0)}}updateBoardFromDOM=()=>{Array.from(t.children).forEach((t,e)=>{Array.from(t.children).forEach((t,s)=>{this.board[e][s]=""===t.textContent?0:t.textContent})})};clearBoard(){t.querySelectorAll("td").forEach(t=>{t.textContent="",t.className="field-cell",t.removeAttribute("style")})}restart(){this.board=this.createEmptyBoard(),this.score=0,this.status="playing";let t=document.querySelector(".button"),e=document.querySelector(".message-container");"Start"===t.textContent?(t.style.fontSize="18px",t.textContent="Restart",t.classList.add("restart")):(t.style.fontSize="18px",t.textContent="Start",t.classList.remove("restart"),t.classList.add("start"),e.children[2].textContent='Press "Start" to begin game. Good luck!',e.children[2].classList.add("message-start"),e.children[2].classList.add("message")),this.deleteMessage()}createEmptyBoard(){return[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]}getScore(){return this.score}getStatus(){return this.status}addColor(){Array.from(t.children).forEach(t=>{Array.from(t.children).forEach(t=>{switch(+t.textContent){case 2:t.classList.add("field-cell--2");break;case 4:t.classList.add("field-cell--4");break;case 8:t.classList.add("field-cell--8");break;case 16:t.classList.add("field-cell--16");break;case 32:t.classList.add("field-cell--32");break;case 64:t.classList.add("field-cell--64");break;case 128:t.classList.add("field-cell--128");break;case 256:t.classList.add("field-cell--256");break;case 512:t.classList.add("field-cell--512");break;case 1024:t.classList.add("field-cell--1024");break;case 2048:t.classList.add("field-cell--2048")}})})}canContinueGame(){let t=[[],[],[],[]];this.board.forEach(e=>{t[0].push(e[0]),t[1].push(e[1]),t[2].push(e[2]),t[3].push(e[3])});let e=t=>{let e=t.filter(t=>0!==t),s=e.length,a=0;for(;a<s;){if(e[a]===e[a+1])return!0;a++}};for(let s of t)if(e(s))return!0;let s=[[],[],[],[]];this.board.forEach((t,e)=>{s[e].push(t[0]),s[e].push(t[1]),s[e].push(t[2]),s[e].push(t[3])});let a=t=>{let e=t.filter(t=>0!==t),s=e.length,a=0;for(;a<s;){if(e[a]===e[a+1])return!0;a++}};for(let t of s)if(a(t))return!0;for(let t of this.board)if(t.includes(0))return!0;return!1}addSCore(){document.querySelector(".game-score").textContent=this.score}getMessage(){let t=document.querySelector(".message-container");t.children[2].textContent=t.children[0].textContent,t.children[2].classList.add("message-lose"),t.children[2].classList.add("message")}getMessageWin(){let t=document.querySelector(".message-container"),e=document.querySelector(".message-win");t.children[2].textContent=e.textContent,t.children[2].classList.add("message-win"),t.children[2].classList.add("message")}moveUp(){if(!this.canContinueGame()){this.getMessage(),this.status="finished";return}let e=JSON.stringify(this.board),s=[],a=[],r=[],i=[];this.board.forEach(t=>{s.push(t[0]),a.push(t[1]),r.push(t[2]),i.push(t[3])});let n=t=>{let e=t.filter(t=>0!==t),s=[],a=0;for(;a<e.length;)a<e.length-1&&e[a]===e[a+1]?(s.push(2*e[a]),this.score+=2*e[a],a+=2):(s.push(e[a]),a++);for(;s.length<4;)s.push(0);return s},o=n(s),l=n(a),d=n(r),c=n(i);this.board=[[o[0],l[0],d[0],c[0]],[o[1],l[1],d[1],c[1]],[o[2],l[2],d[2],c[2]],[o[3],l[3],d[3],c[3]]],this.clearBoard();let h=Array.from(t.children);for(let t=0;t<h.length;t++){let e=h[t].children;e[0].textContent=0===o[t]?"":o[t],e[1].textContent=0===l[t]?"":l[t],e[2].textContent=0===d[t]?"":d[t],e[3].textContent=0===c[t]?"":c[t],""!==e[0].textContent&&e[0].classList.add("activ"),""!==e[1].textContent&&e[1].classList.add("activ"),""!==e[2].textContent&&e[2].classList.add("activ"),""!==e[3].textContent&&e[3].classList.add("activ")}e!==JSON.stringify(this.board)&&this.spawnTile(),this.addColor(),this.addSCore(),this.board.some(t=>t.includes(2048))&&this.getMessageWin(),this.updateBoardFromDOM()}moveDown(){let e=[],s=[],a=[],r=[];this.board.forEach(t=>{e.push(t[0]),s.push(t[1]),a.push(t[2]),r.push(t[3])});let i=t=>{let e=t.filter(t=>0!==t),s=[],a=0;for(;a<e.length;)a<e.length-1&&e[a]===e[a+1]?(s.push(2*e[a]),this.score+=2*e[a],a+=2):(s.push(e[a]),a++);for(;s.length<4;)s.unshift(0);return s},n=JSON.stringify(this.board),o=i(e),l=i(s),d=i(a),c=i(r);this.board=[[o[0],l[0],d[0],c[0]],[o[1],l[1],d[1],c[1]],[o[2],l[2],d[2],c[2]],[o[3],l[3],d[3],c[3]]],this.clearBoard();let h=Array.from(t.children);for(let t=0;t<h.length;t++){let e=h[t].children;e[0].textContent=0===o[t]?"":o[t],e[1].textContent=0===l[t]?"":l[t],e[2].textContent=0===d[t]?"":d[t],e[3].textContent=0===c[t]?"":c[t],""!==e[0].textContent&&e[0].classList.add("activ"),""!==e[1].textContent&&e[1].classList.add("activ"),""!==e[2].textContent&&e[2].classList.add("activ"),""!==e[3].textContent&&e[3].classList.add("activ")}n!==JSON.stringify(this.board)&&this.spawnTile(),this.addColor(),this.addSCore(),this.board.some(t=>t.includes(2048))&&this.getMessageWin(),this.updateBoardFromDOM()}moveRight(){if(!this.canContinueGame()){this.getMessage(),this.status="finished";return}let e=t=>{let e=t.filter(t=>0!==t),s=[],a=0;for(;a<e.length;)a<e.length-1&&e[a]===e[a+1]?(s.push(2*e[a]),this.score+=2*e[a],a+=2):(s.push(e[a]),a++);for(;s.length<4;)s.unshift(0);return s},s=JSON.stringify(this.board),a=this.board.map(t=>e(t));this.board=[[a[0][0],a[0][1],a[0][2],a[0][3]],[a[1][0],a[1][1],a[1][2],a[1][3]],[a[2][0],a[2][1],a[2][2],a[2][3]],[a[3][0],a[3][1],a[3][2],a[3][3]]],this.clearBoard();let r=Array.from(t.children);for(let t=0;t<r.length;t++){let e=r[t].children;e[0].textContent=0===a[t][0]?"":a[t][0],e[1].textContent=0===a[t][1]?"":a[t][1],e[2].textContent=0===a[t][2]?"":a[t][2],e[3].textContent=0===a[t][3]?"":a[t][3],""!==e[0].textContent&&e[0].classList.add("activ"),""!==e[1].textContent&&e[1].classList.add("activ"),""!==e[2].textContent&&e[2].classList.add("activ"),""!==e[3].textContent&&e[3].classList.add("activ")}s!==JSON.stringify(this.board)&&this.spawnTile(),this.addColor(),this.addSCore(),this.board.some(t=>t.includes(2048))&&this.getMessageWin(),this.updateBoardFromDOM()}moveLeft(){let e=t=>{let e=t.filter(t=>0!==t),s=[],a=0;for(;a<e.length;)a<e.length-1&&e[a]===e[a+1]?(s.push(2*e[a]),this.score+=2*e[a],a+=2):(s.push(e[a]),a++);for(;s.length<4;)s.push(0);return s},s=JSON.stringify(this.board),a=this.board.map(t=>e(t));this.board=[[a[0][0],a[0][1],a[0][2],a[0][3]],[a[1][0],a[1][1],a[1][2],a[1][3]],[a[2][0],a[2][1],a[2][2],a[2][3]],[a[3][0],a[3][1],a[3][2],a[3][3]]],this.clearBoard();let r=Array.from(t.children);for(let t=0;t<r.length;t++){let e=r[t].children;e[0].textContent=0===a[t][0]?"":a[t][0],e[1].textContent=0===a[t][1]?"":a[t][1],e[2].textContent=0===a[t][2]?"":a[t][2],e[3].textContent=0===a[t][3]?"":a[t][3],""!==e[0].textContent&&e[0].classList.add("activ"),""!==e[1].textContent&&e[1].classList.add("activ"),""!==e[2].textContent&&e[2].classList.add("activ"),""!==e[3].textContent&&e[3].classList.add("activ")}s!==JSON.stringify(this.board)&&this.spawnTile(),this.addColor(),this.addSCore(),this.board.some(t=>t.includes(2048))&&this.getMessageWin(),this.updateBoardFromDOM()}};e.addEventListener("click",()=>{a.start()}),document.addEventListener("keydown",t=>{switch(t.key){case"ArrowUp":a.moveUp();break;case"ArrowDown":a.moveDown();break;case"ArrowRight":a.moveRight();break;case"ArrowLeft":a.moveLeft()}});
//# sourceMappingURL=index.791f1482.js.map
